{"tags":[{"name":"Leetcode","permalink":"http://www.smartyi8979.com/tags/Leetcode/","url":"/async/tags/Leetcode.json","count":82},{"name":"算法","permalink":"http://www.smartyi8979.com/tags/算法/","url":"/async/tags/算法.json","count":84}],"categories":[{"name":"技术","permalink":"http://www.smartyi8979.com/categories/技术/","url":"/async/categories/技术.json","count":85}],"url":"/async/posts/2016/03/26/Word-Search.json","date":1458965590000,"path":{"year":2016,"month":3,"day":26,"name":"Word-Search"},"title":"Word Search I&&II","permalink":"http://www.smartyi8979.com/2016/03/26/Word-Search/","content":"<h4 id=\"Problem\"><a href=\"#Problem\" class=\"headerlink\" title=\"Problem\"></a>Problem</h4><p>Given a 2D board and a word, find if the word exists in the grid.<br><a id=\"more\"></a></p>\n<p>The word can be constructed from letters of sequentially adjacent cell, where “adjacent” cells are those horizontally or vertically neighboring. The same letter cell may not be used more than once.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">For example,</span><br><span class=\"line\">Given board =</span><br><span class=\"line\"></span><br><span class=\"line\">[</span><br><span class=\"line\">  [&apos;A&apos;,&apos;B&apos;,&apos;C&apos;,&apos;E&apos;],</span><br><span class=\"line\">  [&apos;S&apos;,&apos;F&apos;,&apos;C&apos;,&apos;S&apos;],</span><br><span class=\"line\">  [&apos;A&apos;,&apos;D&apos;,&apos;E&apos;,&apos;E&apos;]</span><br><span class=\"line\">]</span><br><span class=\"line\">word = &quot;ABCCED&quot;, -&gt; returns true,</span><br><span class=\"line\">word = &quot;SEE&quot;, -&gt; returns true,</span><br><span class=\"line\">word = &quot;ABCB&quot;, -&gt; returns false.</span><br></pre></td></tr></table></figure>\n<h4 id=\"分析\"><a href=\"#分析\" class=\"headerlink\" title=\"分析\"></a>分析</h4><p>这种题目，一看到的第一个念头就是dfs查找，连题目都说了是search嘛。dfs就不多讲，直接上代码。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">exist</span><span class=\"params\">(<span class=\"keyword\">char</span>[][] board, String word)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> ret = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> row = board.length;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> col = board[<span class=\"number\">0</span>].length;</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span>[][] visited = <span class=\"keyword\">new</span> <span class=\"keyword\">boolean</span>[row][col];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; row; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; col; j++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (search(i, j, board, visited, word, <span class=\"number\">0</span>)) &#123;</span><br><span class=\"line\">                    ret = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">search</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y, <span class=\"keyword\">char</span>[][] board, <span class=\"keyword\">boolean</span>[][] visited, String word, <span class=\"keyword\">int</span> start)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//必须先判断是否已经字符串匹配完毕，如果匹配完毕，就返回true。</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (start == word.length()) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        <span class=\"comment\">//如果还没匹配完但是已经超出边界，返回false。</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x &lt; <span class=\"number\">0</span> || y &lt; <span class=\"number\">0</span> || x &gt;= board.length || y &gt;= board[<span class=\"number\">0</span>].length) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"comment\">//如果当前字符和当前匹配字符不同，返回false。</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (board[x][y] != word.charAt(start)) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> ret = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"comment\">//保证只访问一次。</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!visited[x][y]) &#123;</span><br><span class=\"line\">            visited[x][y] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            start++;</span><br><span class=\"line\">            ret = search(x + <span class=\"number\">1</span>, y, board, visited, word, start)</span><br><span class=\"line\">                 ||search(x - <span class=\"number\">1</span>, y, board, visited, word, start)</span><br><span class=\"line\">                 ||search(x, y + <span class=\"number\">1</span>, board, visited, word, start)</span><br><span class=\"line\">                 ||search(x, y - <span class=\"number\">1</span>, board, visited, word, start);</span><br><span class=\"line\">            <span class=\"comment\">//backtracking。</span></span><br><span class=\"line\">            visited[x][y] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>值得注意的是一次搜索失败并不代表不存在，要把每种情况考虑在内之后，才能真正的知道是否存在。</p>\n<h4 id=\"Problem-2\"><a href=\"#Problem-2\" class=\"headerlink\" title=\"Problem 2:\"></a>Problem 2:</h4><p>第二题是在第一题的基础上走得更远了一步。给定一些单词和一个二维char board，叫你找出包含在这个board中的所有单词。还记得上题我们是判断一个单词是否在board中，而这一题就是要找出所有存在board中的单词。当然最直观的想法是将上一题的代码上外套一个循环，就可以完事。当然不会如此简单，但是我还是试了一下，果然TLE。那就需要我们从其他角度进行思考了。看了看讨论区的思路，基本上通过的代码都指向一个解法，那就是Trie，单词树，又叫前缀树。那我们就从这给角度加上backtracking能否解答这道题目呢？<br>单词树的实现在之前的题目中有给出来，基本上也是很简单的实现，就是自己定义一个单词树node，然后每个node接26个子node，除此之外还得知道当前node是否是某个单词的结尾，也就是从根节点到当前节点是否构成一个单词。<br>好，我们首先来构造单词树。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//这是Trie节点。</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TrieNode</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">public</span> TrieNode[] next = <span class=\"keyword\">new</span> TrieNode[<span class=\"number\">26</span>];</span><br><span class=\"line\">        <span class=\"keyword\">public</span> String val = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//构建Trie树。</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> TrieNode <span class=\"title\">buildTrie</span><span class=\"params\">(String[] words)</span> </span>&#123;</span><br><span class=\"line\">        TrieNode root = <span class=\"keyword\">new</span> TrieNode();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (String word : words) &#123;</span><br><span class=\"line\">            TrieNode node = root;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">char</span> c : word.toCharArray()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> index = c - <span class=\"string\">'a'</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (node.next[index] != <span class=\"keyword\">null</span>) node.next[index] = <span class=\"keyword\">new</span> TrieNode();</span><br><span class=\"line\">                node = node.next[index];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            node.val = word;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> root;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p>好，至此单词树构建完毕，那么接下来如何进行呢？对board中的每一个点作为搜索起始点进行搜索，将搜索到的单词放入最终结果中。  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> List&lt;String&gt; <span class=\"title\">findWords</span><span class=\"params\">(<span class=\"keyword\">char</span>[][] board, String[] words)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;String&gt; ret = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> row = board.length;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> col = board[<span class=\"number\">0</span>].length;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (row &lt;= <span class=\"number\">0</span> || col &lt;= <span class=\"number\">0</span>) <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">        TrieNode root = buildTrie(words);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; row; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; col; j++) &#123;</span><br><span class=\"line\">                search(i, j, ret, root, board);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">search</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y, List&lt;String&gt; ret, TrieNode root, <span class=\"keyword\">char</span>[][] board)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> cur = board[x][y];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cur == <span class=\"string\">'#'</span> || root.next[cur - <span class=\"string\">'a'</span>] == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        root = root.next[cur - <span class=\"string\">'a'</span>];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root.val != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            ret.add(root.val);</span><br><span class=\"line\">            root.val = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        board[x][y] = <span class=\"string\">'#'</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x + <span class=\"number\">1</span> &lt; board.length) search(x + <span class=\"number\">1</span>, y, ret, root, board);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x &gt; <span class=\"number\">0</span>) search(x - <span class=\"number\">1</span>, y, ret, root, board);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (y + <span class=\"number\">1</span> &lt; board[<span class=\"number\">0</span>].length) search(x, y + <span class=\"number\">1</span>, ret, root, board);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (y &gt; <span class=\"number\">0</span>) search(x, y - <span class=\"number\">1</span>, ret, root, board);</span><br><span class=\"line\">        board[x][y] = cur;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p>注意，这里的搜索终止条件并不是遇到一个单词就终止，而是重复访问和单词不存在。<br>这个题目还是很难的，难点在于想到单词树这个数据结构。</p>\n"}